<VirtualHost *:80>
    ServerName localhost

    DocumentRoot /var/www/html

    ProxyPreserveHost On
    ProxyRequests Off

    # Proxy para la API - MÁS ESPECÍFICO PRIMERO
    ProxyPass /inventario/api/ http://inventario-app:3000/api/
    ProxyPassReverse /inventario/api/ http://inventario-app:3000/api/

    # Proxy para la aplicación principal - MÁS GENERAL DESPUÉS
    ProxyPass /inventario/ http://inventario-app:3000/inventario/
    ProxyPassReverse /inventario/ http://inventario-app:3000/inventario/

    RequestHeader set X-Forwarded-Proto "http"
    RequestHeader set X-Forwarded-Port "80"
    RequestHeader set X-Forwarded-Prefix "/inventario"

    # La ruta de los archivos estáticos dentro del contenedor Apache
    <Directory /var/www/html/inventario_soporte/public>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    # Alias para archivos estáticos del inventario
    # Aquí es importante si quieres servir estáticos directamente desde Apache
    Alias /inventario /var/www/html/inventario_soporte/public

    <IfModule mod_mime.c>
        AddType text/css .css
        AddType application/javascript .js
        AddType image/svg+xml .svg
        AddType image/png .png
        AddType image/jpeg .jpg .jpeg
        AddType image/gif .gif
        AddType image/x-icon .ico
        AddType application/font-woff .woff
        AddType application/font-woff2 .woff2
        AddType application/x-font-ttf .ttf
        AddType application/vnd.ms-fontobject .eot
    </IfModule>

    <IfModule mod_headers.c>
        <FilesMatch "\.css$">
            Header set Content-Type "text/css"
        </FilesMatch>

        <FilesMatch "\.js$">
            Header set Content-Type "application/javascript"
        </FilesMatch>

        <FilesMatch "\.svg$">
            Header set Content-Type "image/svg+xml"
        </FilesMatch>
    </IfModule>
</VirtualHost>

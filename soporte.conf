<VirtualHost *:80>
    ServerName localhost
    
    # DocumentRoot principal (para otros sistemas)
    DocumentRoot /var/www/html
    
    # Configuración del proxy reverso
    ProxyPreserveHost On
    ProxyRequests Off
    
    # Proxy para la API - MÁS ESPECÍFICO PRIMERO
    ProxyPass /soporte/api/ http://inventario-nodejs-app:3000/api/
    ProxyPassReverse /soporte/api/ http://inventario-nodejs-app:3000/api/
    
    # Proxy para la aplicación principal - MÁS GENERAL DESPUÉS
    ProxyPass /soporte/ http://inventario-nodejs-app:3000/soporte/
    ProxyPassReverse /soporte/ http://inventario-nodejs-app:3000/soporte/
    
    # Headers necesarios para el proxy
    RequestHeader set X-Forwarded-Proto "http"
    RequestHeader set X-Forwarded-Port "80"
    RequestHeader set X-Forwarded-Prefix "/soporte"
    
    # Configuración para archivos estáticos del soporte
    <Directory /var/www/html/inventario_soporte/public>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>
    
    # Alias para archivos estáticos del soporte
    Alias /soporte /var/www/html/inventario_soporte/public
    
    # Configuración de MIME types
    <IfModule mod_mime.c>
        AddType text/css .css
        AddType application/javascript .js
        AddType image/svg+xml .svg
        AddType image/png .png
        AddType image/jpeg .jpg .jpeg
        AddType image/gif .gif
        AddType image/x-icon .ico
        AddType application/font-woff .woff
        AddType application/font-woff2 .woff2
        AddType application/x-font-ttf .ttf
        AddType application/vnd.ms-fontobject .eot
    </IfModule>
    
    # Configuración de headers para MIME types
    <IfModule mod_headers.c>
        <FilesMatch "\.css$">
            Header set Content-Type "text/css"
        </FilesMatch>
        
        <FilesMatch "\.js$">
            Header set Content-Type "application/javascript"
        </FilesMatch>
        
        <FilesMatch "\.svg$">
            Header set Content-Type "image/svg+xml"
        </FilesMatch>
    </IfModule>
</VirtualHost> 